<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>GrapesJS</title>
  <!-- https://fontawesome.com/v4/icons/ -->
  <link rel="stylesheet" href="dist/css/grapes.min.css">
  <script src="grapes.min.js"></script>
  <style>
    body,
    html {
      height: 100%;
      margin: 0;
    }

    .container {
      height: 100%;
    }

    .main {
      display: flex;
      width: 100%;
      height: calc(100% - 40px);
    }

    .main main {
      flex-grow: 1;
    }

    header {
      display: flex;
      height: 40px;
      background-color: #444;
    }

    header .gjs-pn-panel {
      position: static;
      z-index: initial;
    }

    .left-bar {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      position: relative;
      width: 50px;
      height: 100%;
      padding-top: 10px;
      background-color: #444;
    }

    header .brand-icon {
      width: 50px;
    }

    header .common-tools {
      flex-grow: 1;
      display: flex;
      justify-content: space-around;
    }

    header .advance-tools {
      display: flex;
      width: calc((100vw - 50px) * 0.15);
    }

    header .page-title {
      display: flex;
      align-items: center;
    }

    header .page-title input {
      height: 24px;
      width: 200px;
      background-color: #5a584f;
      outline: none;
      border: 1px solid #746d6d;
      color: white;
      padding-left: 5px;
    }

    .left-bar .gjs-pn-panel {
      position: static;
      width: 100%;
      padding: 0;
    }

    .left-bar .gjs-pn-buttons {
      flex-direction: column;
    }

    #kits-drawer {
      width: 200px;
      position: absolute;
      z-index: 5;
      top: 0;
      left: 50px;
    }

    #kits-drawer .gjs-pn-layers-viewer,
    #kits-drawer .gjs-pn-blocks-viewer {
      height: calc(100vh - 40px);
      overflow: scroll;
    }

    /* 覆盖 */
    #main-editor .gjs-cv-canvas {
      height: 100%;
      top: 0
    }

    .gjs-pn-views {
      border-bottom: 0
    }

    #main-editor .gjs-pn-views-container {
      padding: 0
    }

    .traits-panel,
    .gjs-clm-tags {
      background-color: #6b6864;
    }

    .traits-panel .gjs-trt-traits {
      background-color: inherit;
    }

    .gjs-clm-tags-header {
      display: flex;
      align-items: center;
    }

    #kits-drawer .gjs-block-category .gjs-title {
      padding: 5px 10px
    }

    #kits-drawer .gjs-block {
      width: 30%;
      margin: 10px 1.5% 5px;
      min-height: auto;
      padding: 0 0 5px;
    }

    #kits-drawer .gjs-block-label {
      text-overflow: initial;
      white-space: nowrap;
    }

    #kits-drawer .gjs-block__media {
      margin-bottom: 0;
      padding: 10px 10px 5px;
    }

    .gjs-mdl-container[data-custom-modal] #gjs-mdl-c {
      overflow-x: scroll;
    }

    .gjs-mdl-container[data-custom-modal] .gjs-export-dl {
      width: 150%;
      display: flex;
    }

    .gjs-mdl-container[data-custom-modal] .gjs-cm-editor-c {
      float: none;
      width: 33.3%;
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <div class="brand-icon">
        <svg width="100%" height="100%" viewBox="0 0 125 120" version="1.1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g>
              <path
                d="M60,0.5 C78.3306495,0.5 101.058233,8.76826427 114.077332,21.7873633 C119.504117,27.2141485 123.241792,33.4679276 124.2283,40.2995049 C125.107416,46.3873958 123.795086,52.9268964 119.574995,59.7366175 C115.363588,66.5323254 111.74893,73.0643627 108.37832,79.1557177 C101.056671,92.3873797 94.9037003,103.537474 86.2346958,110.747857 C79.5546085,116.303972 71.3740659,119.5 60,119.5 C43.5695287,119.5 28.6945287,112.840236 17.9271465,102.072853 C7.15976435,91.3054713 0.5,76.4304713 0.5,60 C0.5,43.5695287 7.15976435,28.6945287 17.9271465,17.9271465 C28.6945287,7.15976435 43.5695287,0.5 60,0.5 Z"
                stroke="#FFAB00" fill="#FF8950"></path>
              <rect fill="#0071FF" x="55" y="0" width="10" height="120" rx="5"></rect>
              <rect fill="#00C500" x="0" y="55" width="119" height="10" rx="5"></rect>
              <rect fill="#FF0027" x="55" y="55" width="10" height="10"></rect>
            </g>
          </g>
        </svg>
      </div>
      <div class="common-tools">
        <div class="page-title">
          <input type="text" value="untitled" />
        </div>
        <div class="device-btns"></div>
        <div class="view-btns"></div>
      </div>
      <div class="advance-tools">
        <div class="paint-btns"></div>
        <div class="page-config"></div>
      </div>
    </header>
    <div class="main">
      <aside id="left-bar" class="left-bar">
        <div class="top-btns"></div>
        <div class="bottom-btns"></div>
        <div id="kits-drawer"></div>
      </aside>
      <main>
        <div id="main-editor" style="height:0px; overflow:hidden;">
          <div class="panel">
            <h1 class="welcome">Welcome to</h1>
            <div class="big-title">
              <svg class="logo" width="100%" height="100%" viewBox="0 0 125 120" version="1.1"
                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="test-logo">
                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                  <g id="编组">
                    <path
                      d="M60,0.5 C78.3306495,0.5 101.058233,8.76826427 114.077332,21.7873633 C119.504117,27.2141485 123.241792,33.4679276 124.2283,40.2995049 C125.107416,46.3873958 123.795086,52.9268964 119.574995,59.7366175 C115.363588,66.5323254 111.74893,73.0643627 108.37832,79.1557177 C101.056671,92.3873797 94.9037003,103.537474 86.2346958,110.747857 C79.5546085,116.303972 71.3740659,119.5 60,119.5 C43.5695287,119.5 28.6945287,112.840236 17.9271465,102.072853 C7.15976435,91.3054713 0.5,76.4304713 0.5,60 C0.5,43.5695287 7.15976435,28.6945287 17.9271465,17.9271465 C28.6945287,7.15976435 43.5695287,0.5 60,0.5 Z"
                      id="椭圆形" stroke="#FFAB00" fill="#FF8950"></path>
                    <rect fill="#0071FF" x="55" y="0" width="10" height="120" rx="5"></rect>
                    <rect fill="#00C500" x="0" y="55" width="119" height="10" rx="5"></rect>
                    <rect fill="#FF0027" x="55" y="55" width="10" height="10"></rect>
                  </g>
                </g>
              </svg>
              <strong>PagePai</strong>
            </div>
            <div class="description">
              <p>DTC 自己的低代码编辑器。</p>
            </div>
          </div>
          <style>
            .panel {
              width: 90%;
              max-width: 700px;
              border-radius: 3px;
              padding: 30px 20px;
              margin: 150px auto 0px;
              background-color: #8bc34a;
              box-shadow: 0px 3px 10px 0px rgba(0, 0, 0, 0.25);
              color: rgba(255, 255, 255, 0.75);
              font: caption;
              font-weight: 100;
            }

            .welcome {
              text-align: center;
              font-weight: 100;
              margin: 0px;
            }

            .logo {
              width: 70px;
              height: 70px;
              vertical-align: middle;
            }

            #test-logo {
              width: 71px
            }

            .logo path {
              pointer-events: none;
              fill: none;
              stroke-linecap: round;
              stroke-width: 7;
            }

            .big-title {
              text-align: center;
              font-size: 3.5rem;
              margin: 15px 0;
            }

            .description {
              text-align: justify;
              font-size: 1rem;
              line-height: 1.5rem;
            }
          </style>
        </div>
      </main>
    </div>
  </div>
  <!-- <script src="https://unpkg.com/grapesjs-style-gradient"></script> -->
  <!-- <script src="https://unpkg.com/grapesjs-tabs"></script> -->
  <script src="https://unpkg.com/grapesjs-plugin-forms"></script>
  <!-- <script src="https://unpkg.com/grapesjs-custom-code"></script> -->
  <script src="https://unpkg.com/grapesjs-component-countdown"></script>
  <!-- <script src="https://unpkg.com/grapesjs-echarts.min.js"></script> -->
  <!-- <script src="https://unpkg.com/grapesjs-preset-webpage"></script> -->
  <script src="./plugins/grapesjs-editor-presets/dist/index.js"></script>
  <script src="./plugins/grapesjs-editor-components/dist/index.js"></script>
  <!-- <script src="https://unpkg.com/grapesjs-lory-slider"></script> bug -->
  <!-- git@github.com:kaoz70/grapesjs-swiper-slider.git -->
  <!-- <link rel="stylesheet" href="https://unpkg.com/grapesjs-project-manager/dist/grapesjs-project-manager.min.css"> -->
  <!-- <script src="https://unpkg.com/grapesjs-project-manager"></script> -->
  <script type="text/javascript">
    var editor = grapesjs.init({
      dragMode: 'translate', // 'absolute' | 'translate'
      showOffsets: 1,
      noticeOnUnload: 0,
      container: '#main-editor',
      plugins: [
        // 'gjs-blocks-basic', // gjs 名称坑爹啊
        'grapesjs-editor-presets',
        'grapesjs-editor-components',
        // 'grapesjs-tabs',
        'grapesjs-plugin-forms',
        // 'grapesjs-style-gradient', // 此插件有 bug
        // 'grapesjs-custom-code', // 有 bug
        'grapesjs-component-countdown',  // 有 bug 无法配置启动计时
        // 'grapesjs-lory-slider',  // 有 bug 无法加载
        // 'grapesjs-echarts',
        // 'grapesjs-preset-webpage',
        // 'grapesjs-project-manager',
      ],
      pluginsOpts: {
        'gjs-editor-presets': { flexGrid: true },
        // 'grapesjs-style-gradient': {
        //   colorPicker: 'default',
        //   grapickOpts: {
        //     min: 1,
        //     max: 99,
        //   }
        // }
      },
      pageManager: true,
      storageManager: {
        type: 'indexeddb',
        autosave: false,
        autoload: false,
      },
      height: '100%',
      fromElement: true,
      layerManager: {
        injectTo: '#kits-drawer'
      },
      // selectorManager: {
      //   componentFirst: true,
      // },
      blockManager: {
        injectTo: '#kits-drawer'
      },
      styleManager: {
        sectors: [{
          name: 'General Layout',
          open: false,
          buildProps: ['display', 'position', 'top', 'right', 'left', 'bottom', 'z-index']
        }, {
          name: 'Flex',
          open: false,
          buildProps: ['flex-direction', 'flex-wrap', 'justify-content', 'align-items', 'align-content', 'order', 'flex-basis', 'flex-grow', 'flex-shrink', 'align-self']
        }, {
          name: 'Box Size',
          open: false,
          buildProps: ['width', 'height', 'max-width', 'min-height', 'margin', 'padding'],
        }, {
          name: 'Text Style',
          open: false,
          buildProps: ['font-family', 'font-size', 'font-weight', 'letter-spacing', 'color', 'line-height', 'text-shadow'],
        }, {
          name: 'Box Decorations',
          open: false,
          buildProps: ['border-radius-c', 'border-radius', 'border', 'box-shadow', 'background-color', 'background'],
        }, {
          name: 'Animation',
          open: false,
          buildProps: ['transition', 'perspective', 'transform'],
        }
        ],
      },
    });


    editor.on('selector:add', selector => {
      selector.set({
        private: false, // hide the selector
      });
    });
    // 此插件有 bug
    // editor.StyleManager.addProperty('box_decorations', {
    //   name: 'Gradient',
    //   property: 'background-image',
    //   type: 'gradient',
    //   defaults: 'none'
    // });

    editor.Panels.addPanel({
      id: 'asider-top',
      el: '.top-btns',
      buttons: [
        {
          id: 'open-blocks',
          className: 'plus-btn',
          label: `<svg style="display: block; max-width:22px" viewBox="0 0 24 24"><path fill="currentColor" d="M17,13H13V17H11V13H7V11H11V7H13V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,05,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"></path></svg>`,
          command: 'open-blocks',
          togglable: true,
          attributes: { title: 'Open Blocks' },
        },
        {
          id: 'open-layers',
          className: 'layer-tree',
          command: 'open-layers',
          label: `<svg style="display: block; max-width:22px" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12,16L19.36,10.27L21,9L12,2L3,9L4.63,10.27M12,18.54L4.62,12.81L3,14.07L12,21.07L21,14.07L19.37,12.8L12,18.54Z"></path>
          </svg>`,
          togglable: true,
          attributes: { title: 'Open Layer Manager' },
        },
        {
          id: 'open-shopify-blocks',
          className: 'shopify-icon',
          command: 'open-shopify-blocks',
          label: `<svg style="display: block; max-width:22px" viewBox="0 0 24 24" fill="currentColor"><path d="M19.9 4.7C19.9 4.6 19.8 4.5 19.7 4.5C19.6 4.5 17.8 4.4 17.8 4.4C17.8 4.4 16.5 3.1 16.4 3C16.3 2.9 16 2.9 15.9 2.9C15.9 2.9 15.6 3 15.2 3.1C14.8 1.9 14 0.7 12.7 0.7H12.6C12.1 0.2 11.7 0 11.3 0C8.2 0 6.7 3.9 6.3 5.8C5 6.2 4.2 6.5 4.1 6.5C3.4 6.7 3.4 6.7 3.3 7.4C3.2 7.9 1.4 21.4 1.4 21.4L15.1 24L22.5 22.4C22.6 22.4 19.9 4.8 19.9 4.7ZM12.4 3.8V3.9C11.6 4.1 10.8 4.4 10 4.6C10.5 2.8 11.3 2 12.1 1.6C12.3 2.2 12.4 2.9 12.4 3.8ZM11.2 0.8C11.3 0.8 11.5 0.8 11.6 0.9C10.6 1.4 9.5 2.5 9.1 4.9C8.4 5.2 7.8 5.4 7.2 5.5C7.7 3.7 8.9 0.8 11.2 0.8ZM11.7 11.3C11.7 11.3 10.9 10.9 9.9 10.9C8.5 10.9 8.4 11.8 8.4 12C8.4 13.2 11.6 13.7 11.6 16.6C11.6 18.9 10.1 20.4 8.2 20.4C5.9 20.4 4.6 18.9 4.6 18.9L5.2 16.8C5.2 16.8 6.4 17.9 7.5 17.9C8.2 17.9 8.5 17.4 8.5 17C8.5 15.4 5.8 15.3 5.8 12.6C5.8 10.4 7.4 8.2 10.7 8.2C12 8.2 12.6 8.6 12.6 8.6L11.7 11.3ZM13.2 3.7C13.2 3.6 13.2 3.5 13.2 3.5C13.2 2.7 13.1 2.1 12.9 1.6C13.6 1.7 14 2.5 14.3 3.4C14 3.4 13.6 3.5 13.2 3.7Z"></path></svg>`,
          togglable: true,
          attributes: { title: 'Open Shopify Blocks' },
        },
        {
          id: 'open-components',
          className: 'cute-icon',
          command: 'open-components',
          label: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15L6.04 7.5 12 10.85l5.96-3.35L12 4.15M5 15.91l6 3.38v-6.71L5 9.21v6.7m14 0v-6.7l-6 3.37v6.71l6-3.38z"></path>
          </svg>`,
          togglable: true,
          attributes: { title: 'Open My Components' },
        },
      ]
    });

    editor.Panels.addPanel({
      id: 'asider-bottom',
      el: '.bottom-btns',
      buttons: [
        {
          id: 'export-code',
          className: 'fa fa-code',
          command: 'export-code',
          attributes: { title: 'View code' },
        },
        {
          id: 'open-import',
          command: () => {
            editor.runCommand('open-import');
          },
          label: `<svg style="display: block; max-width:22px" viewBox="0 0 24 24">
              <path fill="currentColor" d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z" />
          </svg>`,
          attributes: { title: 'Import code' },
        },
        {
          id: 'open-config',
          className: 'fa fa-cog',
          command: 'open-config',
          attributes: { title: 'Configurations' },
        },
      ]
    });
    editor.Panels.addPanel({
      id: 'page-config',
      el: '.page-config',
      buttons: [
        {
          id: 'open-page-config',
          className: 'fa fa-flag',
          command: 'open-page-config',
          attributes: { title: 'Page configuration' },
        }]
    });
  </script>
</body>

</html>